}
dd<-optimize(chek,interval = c(0.0001,3),maximum=TRUE)
print(x2 )
print((dd[[2]]^2))
print("****************************")
if ((dd[[2]])+500*dd[[2]]^2<0.000000001)
{break
}
}
#plot(chek,0,3)
# print(i)
print("x2=")
print(x2)
print("delta=")
print(delta)
print(dd[2])
}
d(0.1,0,1,1,0.0002,30)
library(stats)#ED50=0# for negative x
options(digits = 6)
d<-function(v,beta01,beta1,beta2,epsilon,N) {
for (i in 1:20000){
x1<- epsilon*0.5
beta0<- beta2*epsilon*0.5 #alpha
# beta0<- -beta2*epsilon*0.5
x2<-v+i*0.0001
ll<-function(delta1)
{(((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))^2*(1-1/(1+exp(-(beta0+beta1*x1))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x1))))^2*delta1^4/(4*1/(1+exp(-(beta0+beta1*x1)))^4*(1-1/(1+exp(-(beta0+beta1*x1))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x1))))*delta1^3/(1/(1+exp(-(beta0+beta1*x1)))^3*(1-1/(1+exp(-(beta0+beta1*x1))))^3))/((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))*(1-1/(1+exp(-(beta0+beta1*x1)))))+1)^(N/2)-1)))}
f<-optimize(ll,interval = c(-0.3,-0.0001),maximum=TRUE)
delta1<-f[[1]]
lll<-function(delta2)
{(((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))^2*(1-1/(1+exp(-(beta0+beta1*x2))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x2))))^2*delta2^4/(4*1/(1+exp(-(beta0+beta1*x2)))^4*(1-1/(1+exp(-(beta0+beta1*x2))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x2))))*delta2^3/(1/(1+exp(-(beta0+beta1*x2)))^3*(1-1/(1+exp(-(beta0+beta1*x2))))^3))/((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))*(1-1/(1+exp(-(beta0+beta1*x2)))))+1)^(N/2)-1)))}
ff<-optimize(lll,interval = c( -0.3,-0.0001),maximum=TRUE)
delta2<-ff[[1]]
if (ff[[2]]>f[[2]])
delta<-delta2 else delta<-delta1
m<-matrix(0,2,2)
m[1,1]<-(1*((((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))^2*(1-1/(1+exp(-(beta0+beta1*x1))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x1))))^2*delta1^4/(4*1/(1+exp(-(beta0+beta1*x1)))^4*(1-1/(1+exp(-(beta0+beta1*x1))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x1))))*delta1^3/(1/(1+exp(-(beta0+beta1*x1)))^3*(1-1/(1+exp(-(beta0+beta1*x1))))^3))/((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))*(1-1/(1+exp(-(beta0+beta1*x1)))))+1)^(N/2)-1))^(-1))))+(1*((((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))^2*(1-1/(1+exp(-(beta0+beta1*x2))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x2))))^2*delta2^4/(4*1/(1+exp(-(beta0+beta1*x2)))^4*(1-1/(1+exp(-(beta0+beta1*x2))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x2))))*(-delta2)^3/(1/(1+exp(-(beta0+beta1*x2)))^3*(1-1/(1+exp(-(beta0+beta1*x2))))^3))/((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))*(1-1/(1+exp(-(beta0+beta1*x2)))))+1)^(N/2)-1))^(-1))))
m[1,2]<-((x1)*((((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))^2*(1-1/(1+exp(-(beta0+beta1*x1))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x1))))^2*delta1^4/(4*1/(1+exp(-(beta0+beta1*x1)))^4*(1-1/(1+exp(-(beta0+beta1*x1))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x1))))*delta1^3/(1/(1+exp(-(beta0+beta1*x1)))^3*(1-1/(1+exp(-(beta0+beta1*x1))))^3))/((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))*(1-1/(1+exp(-(beta0+beta1*x1)))))+1)^(N/2)-1))^(-1))))+((x2)*((((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))^2*(1-1/(1+exp(-(beta0+beta1*x2))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x2))))^2*delta2^4/(4*1/(1+exp(-(beta0+beta1*x2)))^4*(1-1/(1+exp(-(beta0+beta1*x2))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x2))))*(-delta2)^3/(1/(1+exp(-(beta0+beta1*x2)))^3*(1-1/(1+exp(-(beta0+beta1*x2))))^3))/((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))*(1-1/(1+exp(-(beta0+beta1*x2)))))+1)^(N/2)-1))^(-1))))
m[2,1]<-m[1,2]
m[2,2]<-((x1^2)*((((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))^2*(1-1/(1+exp(-(beta0+beta1*x1))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x1))))^2*delta1^4/(4*1/(1+exp(-(beta0+beta1*x1)))^4*(1-1/(1+exp(-(beta0+beta1*x1))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x1))))*delta1^3/(1/(1+exp(-(beta0+beta1*x1)))^3*(1-1/(1+exp(-(beta0+beta1*x1))))^3))/((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))*(1-1/(1+exp(-(beta0+beta1*x1)))))+1)^(N/2)-1))^(-1))))+((x2^2)*((((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))^2*(1-1/(1+exp(-(beta0+beta1*x2))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x2))))^2*delta2^4/(4*1/(1+exp(-(beta0+beta1*x2)))^4*(1-1/(1+exp(-(beta0+beta1*x2))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x2))))*(-delta2)^3/(1/(1+exp(-(beta0+beta1*x2)))^3*(1-1/(1+exp(-(beta0+beta1*x2))))^3))/((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))*(1-1/(1+exp(-(beta0+beta1*x2)))))+1)^(N/2)-1))^(-1))))
r<- solve(m)
chek<-function(t){
2*(r[1,1]*(1*(((delta^2/(1/(1+exp(-(beta0+beta1*t)))^2*(1-1/(1+exp(-(beta0+beta1*t))))^2)+(1-2*1/(1+exp(-(beta0+beta1*t))))^2*delta^4/(4*1/(1+exp(-(beta0+beta1*t)))^4*(1-1/(1+exp(-(beta0+beta1*t))))^4)+(1-2*1/(1+exp(-(beta0+beta1*t))))*delta^3/(1/(1+exp(-(beta0+beta1*t)))^3*(1-1/(1+exp(-(beta0+beta1*t))))^3))/((delta^2/(1/(1+exp(-(beta0+beta1*t)))*(1-1/(1+exp(-(beta0+beta1*t)))))+1)^(N/2)-1))))+2*r[1,2]*(t*(((delta^2/(1/(1+exp(-(beta0+beta1*t)))^2*(1-1/(1+exp(-(beta0+beta1*t))))^2)+(1-2*1/(1+exp(-(beta0+beta1*t))))^2*delta^4/(4*1/(1+exp(-(beta0+beta1*t)))^4*(1-1/(1+exp(-(beta0+beta1*t))))^4)+(1-2*1/(1+exp(-(beta0+beta1*t))))*delta^3/(1/(1+exp(-(beta0+beta1*t)))^3*(1-1/(1+exp(-(beta0+beta1*t))))^3))/((delta^2/(1/(1+exp(-(beta0+beta1*t)))*(1-1/(1+exp(-(beta0+beta1*t)))))+1)^(N/2)-1))))+r[2,2]*(((t^2)*(((delta^2/(1/(1+exp(-(beta0+beta1*t)))^2*(1-1/(1+exp(-(beta0+beta1*t))))^2)+(1-2*1/(1+exp(-(beta0+beta1*t))))^2*delta^4/(4*1/(1+exp(-(beta0+beta1*t)))^4*(1-1/(1+exp(-(beta0+beta1*t))))^4)+(1-2*1/(1+exp(-(beta0+beta1*t))))*delta^3/(1/(1+exp(-(beta0+beta1*t)))^3*(1-1/(1+exp(-(beta0+beta1*t))))^3))/((delta^2/(1/(1+exp(-(beta0+beta1*t)))*(1-1/(1+exp(-(beta0+beta1*t)))))+1)^(N/2)-1)))^(-1)))-2
)
}
dd<-optimize(chek,interval = c(0.0001,3),maximum=TRUE)
print(x2 )
print((dd[[2]]^2))
print("****************************")
if ((dd[[2]])+500*dd[[2]]^2<0.000000001)
{break
}
}
#plot(chek,0,3)
# print(i)
print("x2=")
print(x2)
print("delta=")
print(delta)
print(dd[2])
}
d(0.1,0,1,1,0.0002,30)
library(stats)#ED50=0# for negative x
options(digits = 6)
d<-function(v,beta01,beta1,beta2,epsilon,N) {
for (i in 1:20000){
x1<- epsilon*0.5
beta0<- beta2*epsilon*0.5 #alpha
# beta0<- -beta2*epsilon*0.5
x2<-v+i*0.0001
ll<-function(delta1)
{(((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))^2*(1-1/(1+exp(-(beta0+beta1*x1))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x1))))^2*delta1^4/(4*1/(1+exp(-(beta0+beta1*x1)))^4*(1-1/(1+exp(-(beta0+beta1*x1))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x1))))*delta1^3/(1/(1+exp(-(beta0+beta1*x1)))^3*(1-1/(1+exp(-(beta0+beta1*x1))))^3))/((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))*(1-1/(1+exp(-(beta0+beta1*x1)))))+1)^(N/2)-1)))}
f<-optimize(ll,interval = c(-0.3,-0.0001),maximum=TRUE)
delta1<-f[[1]]
lll<-function(delta2)
{(((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))^2*(1-1/(1+exp(-(beta0+beta1*x2))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x2))))^2*delta2^4/(4*1/(1+exp(-(beta0+beta1*x2)))^4*(1-1/(1+exp(-(beta0+beta1*x2))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x2))))*delta2^3/(1/(1+exp(-(beta0+beta1*x2)))^3*(1-1/(1+exp(-(beta0+beta1*x2))))^3))/((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))*(1-1/(1+exp(-(beta0+beta1*x2)))))+1)^(N/2)-1)))}
ff<-optimize(lll,interval = c( -0.3,-0.0001),maximum=TRUE)
delta2<-ff[[1]]
if (ff[[2]]>f[[2]])
delta<-delta2 else delta<-delta1
m<-matrix(0,2,2)
m[1,1]<-(1*((((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))^2*(1-1/(1+exp(-(beta0+beta1*x1))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x1))))^2*delta1^4/(4*1/(1+exp(-(beta0+beta1*x1)))^4*(1-1/(1+exp(-(beta0+beta1*x1))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x1))))*delta1^3/(1/(1+exp(-(beta0+beta1*x1)))^3*(1-1/(1+exp(-(beta0+beta1*x1))))^3))/((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))*(1-1/(1+exp(-(beta0+beta1*x1)))))+1)^(N/2)-1))^(-1))))+(1*((((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))^2*(1-1/(1+exp(-(beta0+beta1*x2))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x2))))^2*delta2^4/(4*1/(1+exp(-(beta0+beta1*x2)))^4*(1-1/(1+exp(-(beta0+beta1*x2))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x2))))*(-delta2)^3/(1/(1+exp(-(beta0+beta1*x2)))^3*(1-1/(1+exp(-(beta0+beta1*x2))))^3))/((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))*(1-1/(1+exp(-(beta0+beta1*x2)))))+1)^(N/2)-1))^(-1))))
m[1,2]<-((x1)*((((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))^2*(1-1/(1+exp(-(beta0+beta1*x1))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x1))))^2*delta1^4/(4*1/(1+exp(-(beta0+beta1*x1)))^4*(1-1/(1+exp(-(beta0+beta1*x1))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x1))))*delta1^3/(1/(1+exp(-(beta0+beta1*x1)))^3*(1-1/(1+exp(-(beta0+beta1*x1))))^3))/((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))*(1-1/(1+exp(-(beta0+beta1*x1)))))+1)^(N/2)-1))^(-1))))+((x2)*((((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))^2*(1-1/(1+exp(-(beta0+beta1*x2))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x2))))^2*delta2^4/(4*1/(1+exp(-(beta0+beta1*x2)))^4*(1-1/(1+exp(-(beta0+beta1*x2))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x2))))*(-delta2)^3/(1/(1+exp(-(beta0+beta1*x2)))^3*(1-1/(1+exp(-(beta0+beta1*x2))))^3))/((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))*(1-1/(1+exp(-(beta0+beta1*x2)))))+1)^(N/2)-1))^(-1))))
m[2,1]<-m[1,2]
m[2,2]<-((x1^2)*((((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))^2*(1-1/(1+exp(-(beta0+beta1*x1))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x1))))^2*delta1^4/(4*1/(1+exp(-(beta0+beta1*x1)))^4*(1-1/(1+exp(-(beta0+beta1*x1))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x1))))*delta1^3/(1/(1+exp(-(beta0+beta1*x1)))^3*(1-1/(1+exp(-(beta0+beta1*x1))))^3))/((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))*(1-1/(1+exp(-(beta0+beta1*x1)))))+1)^(N/2)-1))^(-1))))+((x2^2)*((((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))^2*(1-1/(1+exp(-(beta0+beta1*x2))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x2))))^2*delta2^4/(4*1/(1+exp(-(beta0+beta1*x2)))^4*(1-1/(1+exp(-(beta0+beta1*x2))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x2))))*(-delta2)^3/(1/(1+exp(-(beta0+beta1*x2)))^3*(1-1/(1+exp(-(beta0+beta1*x2))))^3))/((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))*(1-1/(1+exp(-(beta0+beta1*x2)))))+1)^(N/2)-1))^(-1))))
r<- solve(m)
chek<-function(t){
2*(r[1,1]*(1*(((delta^2/(1/(1+exp(-(beta0+beta1*t)))^2*(1-1/(1+exp(-(beta0+beta1*t))))^2)+(1-2*1/(1+exp(-(beta0+beta1*t))))^2*delta^4/(4*1/(1+exp(-(beta0+beta1*t)))^4*(1-1/(1+exp(-(beta0+beta1*t))))^4)+(1-2*1/(1+exp(-(beta0+beta1*t))))*delta^3/(1/(1+exp(-(beta0+beta1*t)))^3*(1-1/(1+exp(-(beta0+beta1*t))))^3))/((delta^2/(1/(1+exp(-(beta0+beta1*t)))*(1-1/(1+exp(-(beta0+beta1*t)))))+1)^(N/2)-1))))+2*r[1,2]*(t*(((delta^2/(1/(1+exp(-(beta0+beta1*t)))^2*(1-1/(1+exp(-(beta0+beta1*t))))^2)+(1-2*1/(1+exp(-(beta0+beta1*t))))^2*delta^4/(4*1/(1+exp(-(beta0+beta1*t)))^4*(1-1/(1+exp(-(beta0+beta1*t))))^4)+(1-2*1/(1+exp(-(beta0+beta1*t))))*delta^3/(1/(1+exp(-(beta0+beta1*t)))^3*(1-1/(1+exp(-(beta0+beta1*t))))^3))/((delta^2/(1/(1+exp(-(beta0+beta1*t)))*(1-1/(1+exp(-(beta0+beta1*t)))))+1)^(N/2)-1))))+r[2,2]*(((t^2)*(((delta^2/(1/(1+exp(-(beta0+beta1*t)))^2*(1-1/(1+exp(-(beta0+beta1*t))))^2)+(1-2*1/(1+exp(-(beta0+beta1*t))))^2*delta^4/(4*1/(1+exp(-(beta0+beta1*t)))^4*(1-1/(1+exp(-(beta0+beta1*t))))^4)+(1-2*1/(1+exp(-(beta0+beta1*t))))*delta^3/(1/(1+exp(-(beta0+beta1*t)))^3*(1-1/(1+exp(-(beta0+beta1*t))))^3))/((delta^2/(1/(1+exp(-(beta0+beta1*t)))*(1-1/(1+exp(-(beta0+beta1*t)))))+1)^(N/2)-1)))^(-1)))-2
)
}
dd<-optimize(chek,interval = c(0.0001,3),maximum=TRUE)
print(x2 )
print((dd[[2]]^2))
print("****************************")
if ((dd[[2]])+500*dd[[2]]^2<0.000000001)
{break
}
}
#plot(chek,0,3)
# print(i)
print("x2=")
print(x2)
print("delta=")
print(delta)
print(dd[2])
}
d(0.1,0,1,1,0.0002,8)
library(stats)#ED50=0# for negative x
options(digits = 6)
d<-function(v,beta01,beta1,beta2,epsilon,N) {
for (i in 1:20000){
x1<- epsilon*0.5
beta0<- beta2*epsilon*0.5 #alpha
# beta0<- -beta2*epsilon*0.5
x2<-v-i*0.0001
ll<-function(delta1)
{(((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))^2*(1-1/(1+exp(-(beta0+beta1*x1))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x1))))^2*delta1^4/(4*1/(1+exp(-(beta0+beta1*x1)))^4*(1-1/(1+exp(-(beta0+beta1*x1))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x1))))*delta1^3/(1/(1+exp(-(beta0+beta1*x1)))^3*(1-1/(1+exp(-(beta0+beta1*x1))))^3))/((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))*(1-1/(1+exp(-(beta0+beta1*x1)))))+1)^(N/2)-1)))}
f<-optimize(ll,interval = c(-0.3,-0.0001),maximum=TRUE)
delta1<-f[[1]]
lll<-function(delta2)
{(((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))^2*(1-1/(1+exp(-(beta0+beta1*x2))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x2))))^2*delta2^4/(4*1/(1+exp(-(beta0+beta1*x2)))^4*(1-1/(1+exp(-(beta0+beta1*x2))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x2))))*delta2^3/(1/(1+exp(-(beta0+beta1*x2)))^3*(1-1/(1+exp(-(beta0+beta1*x2))))^3))/((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))*(1-1/(1+exp(-(beta0+beta1*x2)))))+1)^(N/2)-1)))}
ff<-optimize(lll,interval = c( -0.3,-0.0001),maximum=TRUE)
delta2<-ff[[1]]
if (ff[[2]]>f[[2]])
delta<-delta2 else delta<-delta1
m<-matrix(0,2,2)
m[1,1]<-(1*((((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))^2*(1-1/(1+exp(-(beta0+beta1*x1))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x1))))^2*delta1^4/(4*1/(1+exp(-(beta0+beta1*x1)))^4*(1-1/(1+exp(-(beta0+beta1*x1))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x1))))*delta1^3/(1/(1+exp(-(beta0+beta1*x1)))^3*(1-1/(1+exp(-(beta0+beta1*x1))))^3))/((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))*(1-1/(1+exp(-(beta0+beta1*x1)))))+1)^(N/2)-1))^(-1))))+(1*((((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))^2*(1-1/(1+exp(-(beta0+beta1*x2))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x2))))^2*delta2^4/(4*1/(1+exp(-(beta0+beta1*x2)))^4*(1-1/(1+exp(-(beta0+beta1*x2))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x2))))*(-delta2)^3/(1/(1+exp(-(beta0+beta1*x2)))^3*(1-1/(1+exp(-(beta0+beta1*x2))))^3))/((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))*(1-1/(1+exp(-(beta0+beta1*x2)))))+1)^(N/2)-1))^(-1))))
m[1,2]<-((x1)*((((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))^2*(1-1/(1+exp(-(beta0+beta1*x1))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x1))))^2*delta1^4/(4*1/(1+exp(-(beta0+beta1*x1)))^4*(1-1/(1+exp(-(beta0+beta1*x1))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x1))))*delta1^3/(1/(1+exp(-(beta0+beta1*x1)))^3*(1-1/(1+exp(-(beta0+beta1*x1))))^3))/((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))*(1-1/(1+exp(-(beta0+beta1*x1)))))+1)^(N/2)-1))^(-1))))+((x2)*((((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))^2*(1-1/(1+exp(-(beta0+beta1*x2))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x2))))^2*delta2^4/(4*1/(1+exp(-(beta0+beta1*x2)))^4*(1-1/(1+exp(-(beta0+beta1*x2))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x2))))*(-delta2)^3/(1/(1+exp(-(beta0+beta1*x2)))^3*(1-1/(1+exp(-(beta0+beta1*x2))))^3))/((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))*(1-1/(1+exp(-(beta0+beta1*x2)))))+1)^(N/2)-1))^(-1))))
m[2,1]<-m[1,2]
m[2,2]<-((x1^2)*((((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))^2*(1-1/(1+exp(-(beta0+beta1*x1))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x1))))^2*delta1^4/(4*1/(1+exp(-(beta0+beta1*x1)))^4*(1-1/(1+exp(-(beta0+beta1*x1))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x1))))*delta1^3/(1/(1+exp(-(beta0+beta1*x1)))^3*(1-1/(1+exp(-(beta0+beta1*x1))))^3))/((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))*(1-1/(1+exp(-(beta0+beta1*x1)))))+1)^(N/2)-1))^(-1))))+((x2^2)*((((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))^2*(1-1/(1+exp(-(beta0+beta1*x2))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x2))))^2*delta2^4/(4*1/(1+exp(-(beta0+beta1*x2)))^4*(1-1/(1+exp(-(beta0+beta1*x2))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x2))))*(-delta2)^3/(1/(1+exp(-(beta0+beta1*x2)))^3*(1-1/(1+exp(-(beta0+beta1*x2))))^3))/((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))*(1-1/(1+exp(-(beta0+beta1*x2)))))+1)^(N/2)-1))^(-1))))
r<- solve(m)
chek<-function(t){
2*(r[1,1]*(1*(((delta^2/(1/(1+exp(-(beta0+beta1*t)))^2*(1-1/(1+exp(-(beta0+beta1*t))))^2)+(1-2*1/(1+exp(-(beta0+beta1*t))))^2*delta^4/(4*1/(1+exp(-(beta0+beta1*t)))^4*(1-1/(1+exp(-(beta0+beta1*t))))^4)+(1-2*1/(1+exp(-(beta0+beta1*t))))*delta^3/(1/(1+exp(-(beta0+beta1*t)))^3*(1-1/(1+exp(-(beta0+beta1*t))))^3))/((delta^2/(1/(1+exp(-(beta0+beta1*t)))*(1-1/(1+exp(-(beta0+beta1*t)))))+1)^(N/2)-1))))+2*r[1,2]*(t*(((delta^2/(1/(1+exp(-(beta0+beta1*t)))^2*(1-1/(1+exp(-(beta0+beta1*t))))^2)+(1-2*1/(1+exp(-(beta0+beta1*t))))^2*delta^4/(4*1/(1+exp(-(beta0+beta1*t)))^4*(1-1/(1+exp(-(beta0+beta1*t))))^4)+(1-2*1/(1+exp(-(beta0+beta1*t))))*delta^3/(1/(1+exp(-(beta0+beta1*t)))^3*(1-1/(1+exp(-(beta0+beta1*t))))^3))/((delta^2/(1/(1+exp(-(beta0+beta1*t)))*(1-1/(1+exp(-(beta0+beta1*t)))))+1)^(N/2)-1))))+r[2,2]*(((t^2)*(((delta^2/(1/(1+exp(-(beta0+beta1*t)))^2*(1-1/(1+exp(-(beta0+beta1*t))))^2)+(1-2*1/(1+exp(-(beta0+beta1*t))))^2*delta^4/(4*1/(1+exp(-(beta0+beta1*t)))^4*(1-1/(1+exp(-(beta0+beta1*t))))^4)+(1-2*1/(1+exp(-(beta0+beta1*t))))*delta^3/(1/(1+exp(-(beta0+beta1*t)))^3*(1-1/(1+exp(-(beta0+beta1*t))))^3))/((delta^2/(1/(1+exp(-(beta0+beta1*t)))*(1-1/(1+exp(-(beta0+beta1*t)))))+1)^(N/2)-1)))^(-1)))-2
)
}
dd<-optimize(chek,interval = c(0.0001,3),maximum=TRUE)
print(x2 )
print((dd[[2]]^2))
print("****************************")
if ((dd[[2]])+500*dd[[2]]^2<0.000000001)
{break
}
}
#plot(chek,0,3)
# print(i)
print("x2=")
print(x2)
print("delta=")
print(delta)
print(dd[2])
}
d(0.5,0,1,1,0.0002,8)
library(stats)#ED50=0# for negative x
options(digits = 6)
d<-function(v,beta01,beta1,beta2,epsilon,N) {
for (i in 1:20000){
x1<- epsilon*0.5
beta0<- beta2*epsilon*0.5 #alpha
# beta0<- -beta2*epsilon*0.5
x2<-v+i*0.0001
ll<-function(delta1)
{(((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))^2*(1-1/(1+exp(-(beta0+beta1*x1))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x1))))^2*delta1^4/(4*1/(1+exp(-(beta0+beta1*x1)))^4*(1-1/(1+exp(-(beta0+beta1*x1))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x1))))*delta1^3/(1/(1+exp(-(beta0+beta1*x1)))^3*(1-1/(1+exp(-(beta0+beta1*x1))))^3))/((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))*(1-1/(1+exp(-(beta0+beta1*x1)))))+1)^(N/2)-1)))}
f<-optimize(ll,interval = c(-0.3,-0.0001),maximum=TRUE)
delta1<-f[[1]]
lll<-function(delta2)
{(((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))^2*(1-1/(1+exp(-(beta0+beta1*x2))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x2))))^2*delta2^4/(4*1/(1+exp(-(beta0+beta1*x2)))^4*(1-1/(1+exp(-(beta0+beta1*x2))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x2))))*delta2^3/(1/(1+exp(-(beta0+beta1*x2)))^3*(1-1/(1+exp(-(beta0+beta1*x2))))^3))/((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))*(1-1/(1+exp(-(beta0+beta1*x2)))))+1)^(N/2)-1)))}
ff<-optimize(lll,interval = c( -0.3,-0.0001),maximum=TRUE)
delta2<-ff[[1]]
if (ff[[2]]>f[[2]])
delta<-delta2 else delta<-delta1
m<-matrix(0,2,2)
m[1,1]<-(1*((((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))^2*(1-1/(1+exp(-(beta0+beta1*x1))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x1))))^2*delta1^4/(4*1/(1+exp(-(beta0+beta1*x1)))^4*(1-1/(1+exp(-(beta0+beta1*x1))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x1))))*delta1^3/(1/(1+exp(-(beta0+beta1*x1)))^3*(1-1/(1+exp(-(beta0+beta1*x1))))^3))/((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))*(1-1/(1+exp(-(beta0+beta1*x1)))))+1)^(N/2)-1))^(-1))))+(1*((((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))^2*(1-1/(1+exp(-(beta0+beta1*x2))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x2))))^2*delta2^4/(4*1/(1+exp(-(beta0+beta1*x2)))^4*(1-1/(1+exp(-(beta0+beta1*x2))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x2))))*(-delta2)^3/(1/(1+exp(-(beta0+beta1*x2)))^3*(1-1/(1+exp(-(beta0+beta1*x2))))^3))/((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))*(1-1/(1+exp(-(beta0+beta1*x2)))))+1)^(N/2)-1))^(-1))))
m[1,2]<-((x1)*((((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))^2*(1-1/(1+exp(-(beta0+beta1*x1))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x1))))^2*delta1^4/(4*1/(1+exp(-(beta0+beta1*x1)))^4*(1-1/(1+exp(-(beta0+beta1*x1))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x1))))*delta1^3/(1/(1+exp(-(beta0+beta1*x1)))^3*(1-1/(1+exp(-(beta0+beta1*x1))))^3))/((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))*(1-1/(1+exp(-(beta0+beta1*x1)))))+1)^(N/2)-1))^(-1))))+((x2)*((((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))^2*(1-1/(1+exp(-(beta0+beta1*x2))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x2))))^2*delta2^4/(4*1/(1+exp(-(beta0+beta1*x2)))^4*(1-1/(1+exp(-(beta0+beta1*x2))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x2))))*(-delta2)^3/(1/(1+exp(-(beta0+beta1*x2)))^3*(1-1/(1+exp(-(beta0+beta1*x2))))^3))/((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))*(1-1/(1+exp(-(beta0+beta1*x2)))))+1)^(N/2)-1))^(-1))))
m[2,1]<-m[1,2]
m[2,2]<-((x1^2)*((((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))^2*(1-1/(1+exp(-(beta0+beta1*x1))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x1))))^2*delta1^4/(4*1/(1+exp(-(beta0+beta1*x1)))^4*(1-1/(1+exp(-(beta0+beta1*x1))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x1))))*delta1^3/(1/(1+exp(-(beta0+beta1*x1)))^3*(1-1/(1+exp(-(beta0+beta1*x1))))^3))/((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))*(1-1/(1+exp(-(beta0+beta1*x1)))))+1)^(N/2)-1))^(-1))))+((x2^2)*((((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))^2*(1-1/(1+exp(-(beta0+beta1*x2))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x2))))^2*delta2^4/(4*1/(1+exp(-(beta0+beta1*x2)))^4*(1-1/(1+exp(-(beta0+beta1*x2))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x2))))*(-delta2)^3/(1/(1+exp(-(beta0+beta1*x2)))^3*(1-1/(1+exp(-(beta0+beta1*x2))))^3))/((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))*(1-1/(1+exp(-(beta0+beta1*x2)))))+1)^(N/2)-1))^(-1))))
r<- solve(m)
chek<-function(t){
2*(r[1,1]*(1*(((delta^2/(1/(1+exp(-(beta0+beta1*t)))^2*(1-1/(1+exp(-(beta0+beta1*t))))^2)+(1-2*1/(1+exp(-(beta0+beta1*t))))^2*delta^4/(4*1/(1+exp(-(beta0+beta1*t)))^4*(1-1/(1+exp(-(beta0+beta1*t))))^4)+(1-2*1/(1+exp(-(beta0+beta1*t))))*delta^3/(1/(1+exp(-(beta0+beta1*t)))^3*(1-1/(1+exp(-(beta0+beta1*t))))^3))/((delta^2/(1/(1+exp(-(beta0+beta1*t)))*(1-1/(1+exp(-(beta0+beta1*t)))))+1)^(N/2)-1))))+2*r[1,2]*(t*(((delta^2/(1/(1+exp(-(beta0+beta1*t)))^2*(1-1/(1+exp(-(beta0+beta1*t))))^2)+(1-2*1/(1+exp(-(beta0+beta1*t))))^2*delta^4/(4*1/(1+exp(-(beta0+beta1*t)))^4*(1-1/(1+exp(-(beta0+beta1*t))))^4)+(1-2*1/(1+exp(-(beta0+beta1*t))))*delta^3/(1/(1+exp(-(beta0+beta1*t)))^3*(1-1/(1+exp(-(beta0+beta1*t))))^3))/((delta^2/(1/(1+exp(-(beta0+beta1*t)))*(1-1/(1+exp(-(beta0+beta1*t)))))+1)^(N/2)-1))))+r[2,2]*(((t^2)*(((delta^2/(1/(1+exp(-(beta0+beta1*t)))^2*(1-1/(1+exp(-(beta0+beta1*t))))^2)+(1-2*1/(1+exp(-(beta0+beta1*t))))^2*delta^4/(4*1/(1+exp(-(beta0+beta1*t)))^4*(1-1/(1+exp(-(beta0+beta1*t))))^4)+(1-2*1/(1+exp(-(beta0+beta1*t))))*delta^3/(1/(1+exp(-(beta0+beta1*t)))^3*(1-1/(1+exp(-(beta0+beta1*t))))^3))/((delta^2/(1/(1+exp(-(beta0+beta1*t)))*(1-1/(1+exp(-(beta0+beta1*t)))))+1)^(N/2)-1)))^(-1)))-2
)
}
dd<-optimize(chek,interval = c(0.0001,3),maximum=TRUE)
print(x2 )
print((dd[[2]]^2))
print("****************************")
if ((dd[[2]])+500*dd[[2]]^2<0.000000001)
{break
}
}
#plot(chek,0,3)
# print(i)
print("x2=")
print(x2)
print("delta=")
print(delta)
print(dd[2])
}
d(0.1,0,1,1,0.0002,12)
library(stats)#ED50=0# for negative x
options(digits = 6)
d<-function(v,beta01,beta1,beta2,epsilon,N) {
for (i in 1:20000){
x1<- epsilon*0.5
beta0<- beta2*epsilon*0.5 #alpha
# beta0<- -beta2*epsilon*0.5
x2<-v+i*0.0001
ll<-function(delta1)
{(((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))^2*(1-1/(1+exp(-(beta0+beta1*x1))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x1))))^2*delta1^4/(4*1/(1+exp(-(beta0+beta1*x1)))^4*(1-1/(1+exp(-(beta0+beta1*x1))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x1))))*delta1^3/(1/(1+exp(-(beta0+beta1*x1)))^3*(1-1/(1+exp(-(beta0+beta1*x1))))^3))/((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))*(1-1/(1+exp(-(beta0+beta1*x1)))))+1)^(N/2)-1)))}
f<-optimize(ll,interval = c(-0.3,-0.0001),maximum=TRUE)
delta1<-f[[1]]
lll<-function(delta2)
{(((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))^2*(1-1/(1+exp(-(beta0+beta1*x2))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x2))))^2*delta2^4/(4*1/(1+exp(-(beta0+beta1*x2)))^4*(1-1/(1+exp(-(beta0+beta1*x2))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x2))))*delta2^3/(1/(1+exp(-(beta0+beta1*x2)))^3*(1-1/(1+exp(-(beta0+beta1*x2))))^3))/((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))*(1-1/(1+exp(-(beta0+beta1*x2)))))+1)^(N/2)-1)))}
ff<-optimize(lll,interval = c( -0.3,-0.0001),maximum=TRUE)
delta2<-ff[[1]]
if (ff[[2]]>f[[2]])
delta<-delta2 else delta<-delta1
m<-matrix(0,2,2)
m[1,1]<-(1*((((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))^2*(1-1/(1+exp(-(beta0+beta1*x1))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x1))))^2*delta1^4/(4*1/(1+exp(-(beta0+beta1*x1)))^4*(1-1/(1+exp(-(beta0+beta1*x1))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x1))))*delta1^3/(1/(1+exp(-(beta0+beta1*x1)))^3*(1-1/(1+exp(-(beta0+beta1*x1))))^3))/((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))*(1-1/(1+exp(-(beta0+beta1*x1)))))+1)^(N/2)-1))^(-1))))+(1*((((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))^2*(1-1/(1+exp(-(beta0+beta1*x2))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x2))))^2*delta2^4/(4*1/(1+exp(-(beta0+beta1*x2)))^4*(1-1/(1+exp(-(beta0+beta1*x2))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x2))))*(-delta2)^3/(1/(1+exp(-(beta0+beta1*x2)))^3*(1-1/(1+exp(-(beta0+beta1*x2))))^3))/((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))*(1-1/(1+exp(-(beta0+beta1*x2)))))+1)^(N/2)-1))^(-1))))
m[1,2]<-((x1)*((((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))^2*(1-1/(1+exp(-(beta0+beta1*x1))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x1))))^2*delta1^4/(4*1/(1+exp(-(beta0+beta1*x1)))^4*(1-1/(1+exp(-(beta0+beta1*x1))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x1))))*delta1^3/(1/(1+exp(-(beta0+beta1*x1)))^3*(1-1/(1+exp(-(beta0+beta1*x1))))^3))/((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))*(1-1/(1+exp(-(beta0+beta1*x1)))))+1)^(N/2)-1))^(-1))))+((x2)*((((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))^2*(1-1/(1+exp(-(beta0+beta1*x2))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x2))))^2*delta2^4/(4*1/(1+exp(-(beta0+beta1*x2)))^4*(1-1/(1+exp(-(beta0+beta1*x2))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x2))))*(-delta2)^3/(1/(1+exp(-(beta0+beta1*x2)))^3*(1-1/(1+exp(-(beta0+beta1*x2))))^3))/((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))*(1-1/(1+exp(-(beta0+beta1*x2)))))+1)^(N/2)-1))^(-1))))
m[2,1]<-m[1,2]
m[2,2]<-((x1^2)*((((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))^2*(1-1/(1+exp(-(beta0+beta1*x1))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x1))))^2*delta1^4/(4*1/(1+exp(-(beta0+beta1*x1)))^4*(1-1/(1+exp(-(beta0+beta1*x1))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x1))))*delta1^3/(1/(1+exp(-(beta0+beta1*x1)))^3*(1-1/(1+exp(-(beta0+beta1*x1))))^3))/((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))*(1-1/(1+exp(-(beta0+beta1*x1)))))+1)^(N/2)-1))^(-1))))+((x2^2)*((((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))^2*(1-1/(1+exp(-(beta0+beta1*x2))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x2))))^2*delta2^4/(4*1/(1+exp(-(beta0+beta1*x2)))^4*(1-1/(1+exp(-(beta0+beta1*x2))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x2))))*(-delta2)^3/(1/(1+exp(-(beta0+beta1*x2)))^3*(1-1/(1+exp(-(beta0+beta1*x2))))^3))/((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))*(1-1/(1+exp(-(beta0+beta1*x2)))))+1)^(N/2)-1))^(-1))))
r<- solve(m)
chek<-function(t){
2*(r[1,1]*(1*(((delta^2/(1/(1+exp(-(beta0+beta1*t)))^2*(1-1/(1+exp(-(beta0+beta1*t))))^2)+(1-2*1/(1+exp(-(beta0+beta1*t))))^2*delta^4/(4*1/(1+exp(-(beta0+beta1*t)))^4*(1-1/(1+exp(-(beta0+beta1*t))))^4)+(1-2*1/(1+exp(-(beta0+beta1*t))))*delta^3/(1/(1+exp(-(beta0+beta1*t)))^3*(1-1/(1+exp(-(beta0+beta1*t))))^3))/((delta^2/(1/(1+exp(-(beta0+beta1*t)))*(1-1/(1+exp(-(beta0+beta1*t)))))+1)^(N/2)-1))))+2*r[1,2]*(t*(((delta^2/(1/(1+exp(-(beta0+beta1*t)))^2*(1-1/(1+exp(-(beta0+beta1*t))))^2)+(1-2*1/(1+exp(-(beta0+beta1*t))))^2*delta^4/(4*1/(1+exp(-(beta0+beta1*t)))^4*(1-1/(1+exp(-(beta0+beta1*t))))^4)+(1-2*1/(1+exp(-(beta0+beta1*t))))*delta^3/(1/(1+exp(-(beta0+beta1*t)))^3*(1-1/(1+exp(-(beta0+beta1*t))))^3))/((delta^2/(1/(1+exp(-(beta0+beta1*t)))*(1-1/(1+exp(-(beta0+beta1*t)))))+1)^(N/2)-1))))+r[2,2]*(((t^2)*(((delta^2/(1/(1+exp(-(beta0+beta1*t)))^2*(1-1/(1+exp(-(beta0+beta1*t))))^2)+(1-2*1/(1+exp(-(beta0+beta1*t))))^2*delta^4/(4*1/(1+exp(-(beta0+beta1*t)))^4*(1-1/(1+exp(-(beta0+beta1*t))))^4)+(1-2*1/(1+exp(-(beta0+beta1*t))))*delta^3/(1/(1+exp(-(beta0+beta1*t)))^3*(1-1/(1+exp(-(beta0+beta1*t))))^3))/((delta^2/(1/(1+exp(-(beta0+beta1*t)))*(1-1/(1+exp(-(beta0+beta1*t)))))+1)^(N/2)-1)))^(-1)))-2
)
}
dd<-optimize(chek,interval = c(0.0001,3),maximum=TRUE)
print(x2 )
print((dd[[2]]^2))
print("****************************")
if ((dd[[2]])+500*dd[[2]]^2<0.000000001)
{break
}
}
#plot(chek,0,3)
# print(i)
print("x2=")
print(x2)
print("delta=")
print(delta)
print(dd[2])
}
d(0.1,0,1,1,0.0002,12)
library(stats)#ED50=0# for negative x
options(digits = 6)
d<-function(v,beta01,beta1,beta2,epsilon,N) {
for (i in 1:20000){
x1<- epsilon*0.5
beta0<- beta2*epsilon*0.5 #alpha
# beta0<- -beta2*epsilon*0.5
x2<-v-i*0.0001
ll<-function(delta1)
{(((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))^2*(1-1/(1+exp(-(beta0+beta1*x1))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x1))))^2*delta1^4/(4*1/(1+exp(-(beta0+beta1*x1)))^4*(1-1/(1+exp(-(beta0+beta1*x1))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x1))))*delta1^3/(1/(1+exp(-(beta0+beta1*x1)))^3*(1-1/(1+exp(-(beta0+beta1*x1))))^3))/((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))*(1-1/(1+exp(-(beta0+beta1*x1)))))+1)^(N/2)-1)))}
f<-optimize(ll,interval = c(0.0001, 0.3),maximum=TRUE)
delta1<-f[[1]]
lll<-function(delta2)
{(((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))^2*(1-1/(1+exp(-(beta0+beta1*x2))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x2))))^2*delta2^4/(4*1/(1+exp(-(beta0+beta1*x2)))^4*(1-1/(1+exp(-(beta0+beta1*x2))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x2))))*delta2^3/(1/(1+exp(-(beta0+beta1*x2)))^3*(1-1/(1+exp(-(beta0+beta1*x2))))^3))/((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))*(1-1/(1+exp(-(beta0+beta1*x2)))))+1)^(N/2)-1)))}
ff<-optimize(lll,interval = c(0.0001, 0.3),maximum=TRUE)
delta2<-ff[[1]]
if (ff[[2]]>f[[2]])
delta<-delta2 else delta<-delta1
m<-matrix(0,2,2)
m[1,1]<-(1*((((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))^2*(1-1/(1+exp(-(beta0+beta1*x1))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x1))))^2*delta1^4/(4*1/(1+exp(-(beta0+beta1*x1)))^4*(1-1/(1+exp(-(beta0+beta1*x1))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x1))))*delta1^3/(1/(1+exp(-(beta0+beta1*x1)))^3*(1-1/(1+exp(-(beta0+beta1*x1))))^3))/((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))*(1-1/(1+exp(-(beta0+beta1*x1)))))+1)^(N/2)-1))^(-1))))+(1*((((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))^2*(1-1/(1+exp(-(beta0+beta1*x2))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x2))))^2*delta2^4/(4*1/(1+exp(-(beta0+beta1*x2)))^4*(1-1/(1+exp(-(beta0+beta1*x2))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x2))))*(-delta2)^3/(1/(1+exp(-(beta0+beta1*x2)))^3*(1-1/(1+exp(-(beta0+beta1*x2))))^3))/((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))*(1-1/(1+exp(-(beta0+beta1*x2)))))+1)^(N/2)-1))^(-1))))
m[1,2]<-((x1)*((((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))^2*(1-1/(1+exp(-(beta0+beta1*x1))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x1))))^2*delta1^4/(4*1/(1+exp(-(beta0+beta1*x1)))^4*(1-1/(1+exp(-(beta0+beta1*x1))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x1))))*delta1^3/(1/(1+exp(-(beta0+beta1*x1)))^3*(1-1/(1+exp(-(beta0+beta1*x1))))^3))/((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))*(1-1/(1+exp(-(beta0+beta1*x1)))))+1)^(N/2)-1))^(-1))))+((x2)*((((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))^2*(1-1/(1+exp(-(beta0+beta1*x2))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x2))))^2*delta2^4/(4*1/(1+exp(-(beta0+beta1*x2)))^4*(1-1/(1+exp(-(beta0+beta1*x2))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x2))))*(-delta2)^3/(1/(1+exp(-(beta0+beta1*x2)))^3*(1-1/(1+exp(-(beta0+beta1*x2))))^3))/((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))*(1-1/(1+exp(-(beta0+beta1*x2)))))+1)^(N/2)-1))^(-1))))
m[2,1]<-m[1,2]
m[2,2]<-((x1^2)*((((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))^2*(1-1/(1+exp(-(beta0+beta1*x1))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x1))))^2*delta1^4/(4*1/(1+exp(-(beta0+beta1*x1)))^4*(1-1/(1+exp(-(beta0+beta1*x1))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x1))))*delta1^3/(1/(1+exp(-(beta0+beta1*x1)))^3*(1-1/(1+exp(-(beta0+beta1*x1))))^3))/((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))*(1-1/(1+exp(-(beta0+beta1*x1)))))+1)^(N/2)-1))^(-1))))+((x2^2)*((((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))^2*(1-1/(1+exp(-(beta0+beta1*x2))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x2))))^2*delta2^4/(4*1/(1+exp(-(beta0+beta1*x2)))^4*(1-1/(1+exp(-(beta0+beta1*x2))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x2))))*(-delta2)^3/(1/(1+exp(-(beta0+beta1*x2)))^3*(1-1/(1+exp(-(beta0+beta1*x2))))^3))/((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))*(1-1/(1+exp(-(beta0+beta1*x2)))))+1)^(N/2)-1))^(-1))))
r<- solve(m)
chek<-function(t){
2*(r[1,1]*(1*(((delta^2/(1/(1+exp(-(beta0+beta1*t)))^2*(1-1/(1+exp(-(beta0+beta1*t))))^2)+(1-2*1/(1+exp(-(beta0+beta1*t))))^2*delta^4/(4*1/(1+exp(-(beta0+beta1*t)))^4*(1-1/(1+exp(-(beta0+beta1*t))))^4)+(1-2*1/(1+exp(-(beta0+beta1*t))))*delta^3/(1/(1+exp(-(beta0+beta1*t)))^3*(1-1/(1+exp(-(beta0+beta1*t))))^3))/((delta^2/(1/(1+exp(-(beta0+beta1*t)))*(1-1/(1+exp(-(beta0+beta1*t)))))+1)^(N/2)-1))))+2*r[1,2]*(t*(((delta^2/(1/(1+exp(-(beta0+beta1*t)))^2*(1-1/(1+exp(-(beta0+beta1*t))))^2)+(1-2*1/(1+exp(-(beta0+beta1*t))))^2*delta^4/(4*1/(1+exp(-(beta0+beta1*t)))^4*(1-1/(1+exp(-(beta0+beta1*t))))^4)+(1-2*1/(1+exp(-(beta0+beta1*t))))*delta^3/(1/(1+exp(-(beta0+beta1*t)))^3*(1-1/(1+exp(-(beta0+beta1*t))))^3))/((delta^2/(1/(1+exp(-(beta0+beta1*t)))*(1-1/(1+exp(-(beta0+beta1*t)))))+1)^(N/2)-1))))+r[2,2]*(((t^2)*(((delta^2/(1/(1+exp(-(beta0+beta1*t)))^2*(1-1/(1+exp(-(beta0+beta1*t))))^2)+(1-2*1/(1+exp(-(beta0+beta1*t))))^2*delta^4/(4*1/(1+exp(-(beta0+beta1*t)))^4*(1-1/(1+exp(-(beta0+beta1*t))))^4)+(1-2*1/(1+exp(-(beta0+beta1*t))))*delta^3/(1/(1+exp(-(beta0+beta1*t)))^3*(1-1/(1+exp(-(beta0+beta1*t))))^3))/((delta^2/(1/(1+exp(-(beta0+beta1*t)))*(1-1/(1+exp(-(beta0+beta1*t)))))+1)^(N/2)-1)))^(-1)))-2
)
}
dd<-optimize(chek,interval = c(-3,-0.0001),maximum=TRUE)
print(x2 )
print((dd[[2]]^2))
print("****************************")
if ((dd[[2]])+500*dd[[2]]^2<0.000000001)
{break
}
}
#plot(chek,0,3)
# print(i)
print("x2=")
print(x2)
print("delta=")
print(delta)
print(dd[2])
}
d(-0.1,0,1,1,0.0002,8)
library(stats)#ED50=0# for negative x
options(digits = 6)
d<-function(v,beta01,beta1,beta2,epsilon,N) {
for (i in 1:20000){
x1<- epsilon*0.5
beta0<- beta2*epsilon*0.5 #alpha
# beta0<- -beta2*epsilon*0.5
x2<-v+i*0.0001
ll<-function(delta1)
{(((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))^2*(1-1/(1+exp(-(beta0+beta1*x1))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x1))))^2*delta1^4/(4*1/(1+exp(-(beta0+beta1*x1)))^4*(1-1/(1+exp(-(beta0+beta1*x1))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x1))))*delta1^3/(1/(1+exp(-(beta0+beta1*x1)))^3*(1-1/(1+exp(-(beta0+beta1*x1))))^3))/((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))*(1-1/(1+exp(-(beta0+beta1*x1)))))+1)^(N/2)-1)))}
f<-optimize(ll,interval = c( -0.3,-0.0001),maximum=TRUE)
delta1<-f[[1]]
lll<-function(delta2)
{(((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))^2*(1-1/(1+exp(-(beta0+beta1*x2))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x2))))^2*delta2^4/(4*1/(1+exp(-(beta0+beta1*x2)))^4*(1-1/(1+exp(-(beta0+beta1*x2))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x2))))*delta2^3/(1/(1+exp(-(beta0+beta1*x2)))^3*(1-1/(1+exp(-(beta0+beta1*x2))))^3))/((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))*(1-1/(1+exp(-(beta0+beta1*x2)))))+1)^(N/2)-1)))}
ff<-optimize(lll,interval = c(-0.3,-0.0001),maximum=TRUE)
delta2<-ff[[1]]
if (ff[[2]]>f[[2]])
delta<-delta2 else delta<-delta1
m<-matrix(0,2,2)
m[1,1]<-(1*((((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))^2*(1-1/(1+exp(-(beta0+beta1*x1))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x1))))^2*delta1^4/(4*1/(1+exp(-(beta0+beta1*x1)))^4*(1-1/(1+exp(-(beta0+beta1*x1))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x1))))*delta1^3/(1/(1+exp(-(beta0+beta1*x1)))^3*(1-1/(1+exp(-(beta0+beta1*x1))))^3))/((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))*(1-1/(1+exp(-(beta0+beta1*x1)))))+1)^(N/2)-1))^(-1))))+(1*((((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))^2*(1-1/(1+exp(-(beta0+beta1*x2))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x2))))^2*delta2^4/(4*1/(1+exp(-(beta0+beta1*x2)))^4*(1-1/(1+exp(-(beta0+beta1*x2))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x2))))*(-delta2)^3/(1/(1+exp(-(beta0+beta1*x2)))^3*(1-1/(1+exp(-(beta0+beta1*x2))))^3))/((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))*(1-1/(1+exp(-(beta0+beta1*x2)))))+1)^(N/2)-1))^(-1))))
m[1,2]<-((x1)*((((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))^2*(1-1/(1+exp(-(beta0+beta1*x1))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x1))))^2*delta1^4/(4*1/(1+exp(-(beta0+beta1*x1)))^4*(1-1/(1+exp(-(beta0+beta1*x1))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x1))))*delta1^3/(1/(1+exp(-(beta0+beta1*x1)))^3*(1-1/(1+exp(-(beta0+beta1*x1))))^3))/((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))*(1-1/(1+exp(-(beta0+beta1*x1)))))+1)^(N/2)-1))^(-1))))+((x2)*((((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))^2*(1-1/(1+exp(-(beta0+beta1*x2))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x2))))^2*delta2^4/(4*1/(1+exp(-(beta0+beta1*x2)))^4*(1-1/(1+exp(-(beta0+beta1*x2))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x2))))*(-delta2)^3/(1/(1+exp(-(beta0+beta1*x2)))^3*(1-1/(1+exp(-(beta0+beta1*x2))))^3))/((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))*(1-1/(1+exp(-(beta0+beta1*x2)))))+1)^(N/2)-1))^(-1))))
m[2,1]<-m[1,2]
m[2,2]<-((x1^2)*((((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))^2*(1-1/(1+exp(-(beta0+beta1*x1))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x1))))^2*delta1^4/(4*1/(1+exp(-(beta0+beta1*x1)))^4*(1-1/(1+exp(-(beta0+beta1*x1))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x1))))*delta1^3/(1/(1+exp(-(beta0+beta1*x1)))^3*(1-1/(1+exp(-(beta0+beta1*x1))))^3))/((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))*(1-1/(1+exp(-(beta0+beta1*x1)))))+1)^(N/2)-1))^(-1))))+((x2^2)*((((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))^2*(1-1/(1+exp(-(beta0+beta1*x2))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x2))))^2*delta2^4/(4*1/(1+exp(-(beta0+beta1*x2)))^4*(1-1/(1+exp(-(beta0+beta1*x2))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x2))))*(-delta2)^3/(1/(1+exp(-(beta0+beta1*x2)))^3*(1-1/(1+exp(-(beta0+beta1*x2))))^3))/((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))*(1-1/(1+exp(-(beta0+beta1*x2)))))+1)^(N/2)-1))^(-1))))
r<- solve(m)
chek<-function(t){
2*(r[1,1]*(1*(((delta^2/(1/(1+exp(-(beta0+beta1*t)))^2*(1-1/(1+exp(-(beta0+beta1*t))))^2)+(1-2*1/(1+exp(-(beta0+beta1*t))))^2*delta^4/(4*1/(1+exp(-(beta0+beta1*t)))^4*(1-1/(1+exp(-(beta0+beta1*t))))^4)+(1-2*1/(1+exp(-(beta0+beta1*t))))*delta^3/(1/(1+exp(-(beta0+beta1*t)))^3*(1-1/(1+exp(-(beta0+beta1*t))))^3))/((delta^2/(1/(1+exp(-(beta0+beta1*t)))*(1-1/(1+exp(-(beta0+beta1*t)))))+1)^(N/2)-1))))+2*r[1,2]*(t*(((delta^2/(1/(1+exp(-(beta0+beta1*t)))^2*(1-1/(1+exp(-(beta0+beta1*t))))^2)+(1-2*1/(1+exp(-(beta0+beta1*t))))^2*delta^4/(4*1/(1+exp(-(beta0+beta1*t)))^4*(1-1/(1+exp(-(beta0+beta1*t))))^4)+(1-2*1/(1+exp(-(beta0+beta1*t))))*delta^3/(1/(1+exp(-(beta0+beta1*t)))^3*(1-1/(1+exp(-(beta0+beta1*t))))^3))/((delta^2/(1/(1+exp(-(beta0+beta1*t)))*(1-1/(1+exp(-(beta0+beta1*t)))))+1)^(N/2)-1))))+r[2,2]*(((t^2)*(((delta^2/(1/(1+exp(-(beta0+beta1*t)))^2*(1-1/(1+exp(-(beta0+beta1*t))))^2)+(1-2*1/(1+exp(-(beta0+beta1*t))))^2*delta^4/(4*1/(1+exp(-(beta0+beta1*t)))^4*(1-1/(1+exp(-(beta0+beta1*t))))^4)+(1-2*1/(1+exp(-(beta0+beta1*t))))*delta^3/(1/(1+exp(-(beta0+beta1*t)))^3*(1-1/(1+exp(-(beta0+beta1*t))))^3))/((delta^2/(1/(1+exp(-(beta0+beta1*t)))*(1-1/(1+exp(-(beta0+beta1*t)))))+1)^(N/2)-1)))^(-1)))-2
)
}
dd<-optimize(chek,interval = c(0.0001,3),maximum=TRUE)
print(x2 )
print((dd[[2]]^2))
print("****************************")
if ((dd[[2]])+500*dd[[2]]^2<0.000000001)
{break
}
}
#plot(chek,0,3)
# print(i)
print("x2=")
print(x2)
print("delta=")
print(delta)
print(dd[2])
}
d(0.1,0,1,1,0.0002,8)
library(stats)
options(digits = 6)
d<-function(v,beta,mu,N) {
for (i in 1:10000){
x<-v-i*0.0001
ll<-function(delta)
{(((delta^2/(1/(1+exp(-x))^2*(1-1/(1+exp(-x)))^2)+(1-2*1/(1+exp(-x)))^2*delta^4/(4*1/(1+exp(-x))^4*(1-1/(1+exp(-x)))^4)+(1-2*1/(1+exp(-x)))*delta^3/(1/(1+exp(-x))^3*(1-1/(1+exp(-x)))^3))/((delta^2/(1/(1+exp(-x))*(1-1/(1+exp(-x))))+1)^(N/2)-1)))}
f<-optimize(ll,interval = c(0.0001,0.3),maximum=TRUE)
delta<-f[[1]]
m<-matrix(0,2,2)
m[1,1]<-(beta^2*((((delta^2/(1/(1+exp(-x))^2*(1-1/(1+exp(-x)))^2)+(1-2*1/(1+exp(-x)))^2*delta^4/(4*1/(1+exp(-x))^4*(1-1/(1+exp(-x)))^4)+(1-2*1/(1+exp(-x)))*delta^3/(1/(1+exp(-x))^3*(1-1/(1+exp(-x)))^3))/((delta^2/(1/(1+exp(-x))*(1-1/(1+exp(-x))))+1)^(N/2)-1))^(-1))))+(beta^2*((((delta^2/(1/(1+exp(x))^2*(1-1/(1+exp(x)))^2)+(1-2*1/(1+exp(x)))^2*delta^4/(4*1/(1+exp(x))^4*(1-1/(1+exp(x)))^4)+(1-2*1/(1+exp(x)))*(-delta)^3/(1/(1+exp(x))^3*(1-1/(1+exp(x)))^3))/((delta^2/(1/(1+exp(x))*(1-1/(1+exp(x))))+1)^(N/2)-1))^(-1))))
m[1,2]<-(-beta*((x-mu)*(((delta^2/(1/(1+exp(-x))^2*(1-1/(1+exp(-x)))^2)+(1-2*1/(1+exp(-x)))^2*delta^4/(4*1/(1+exp(-x))^4*(1-1/(1+exp(-x)))^4)+(1-2*1/(1+exp(-x)))*delta^3/(1/(1+exp(-x))^3*(1-1/(1+exp(-x)))^3))/((delta^2/(1/(1+exp(-x))*(1-1/(1+exp(-x))))+1)^(N/2)-1)))^(-1)))+(-beta*((-x-mu)*(((delta^2/(1/(1+exp(x))^2*(1-1/(1+exp(x)))^2)+(1-2*1/(1+exp(x)))^2*delta^4/(4*1/(1+exp(x))^4*(1-1/(1+exp(x)))^4)+(1-2*1/(1+exp(x)))*(-delta)^3/(1/(1+exp(x))^3*(1-1/(1+exp(x)))^3))/((delta^2/(1/(1+exp(x))*(1-1/(1+exp(x))))+1)^(N/2)-1)))^(-1)))
m[2,1]<-m[1,2]
m[2,2]<-(((x-mu)^2*(((delta^2/(1/(1+exp(-x))^2*(1-1/(1+exp(-x)))^2)+(1-2*1/(1+exp(-x)))^2*delta^4/(4*1/(1+exp(-x))^4*(1-1/(1+exp(-x)))^4)+(1-2*1/(1+exp(-x)))*delta^3/(1/(1+exp(-x))^3*(1-1/(1+exp(-x)))^3))/((delta^2/(1/(1+exp(-x))*(1-1/(1+exp(-x))))+1)^(N/2)-1)))^(-1)))+(((-x-mu)^2*(((delta^2/(1/(1+exp(x))^2*(1-1/(1+exp(x)))^2)+(1-2*1/(1+exp(x)))^2*delta^4/(4*1/(1+exp(x))^4*(1-1/(1+exp(x)))^4)+(1-2*1/(1+exp(x)))*(-delta^3)/(1/(1+exp(x))^3*(1-1/(1+exp(-x)))^3))/((delta^2/(1/(1+exp(x))*(1-1/(1+exp(x))))+1)^(N/2)-1)))^(-1)))
r<- solve(m)
chek<-function(t){
2*(  r[1,1]*(beta^2*((((delta^2/(1/(1+exp(-t))^2*(1-1/(1+exp(-t)))^2)+(1-2*1/(1+exp(-t)))^2*delta^4/(4*1/(1+exp(-t))^4*(1-1/(1+exp(-t)))^4)+(1-2*1/(1+exp(-t)))*(delta^3)/(1/(1+exp(-t))^3*(1-1/(1+exp(-t)))^3))/((delta^2/(1/(1+exp(-t))*(1-1/(1+exp(-t))))+1)^(N/2)-1))^(-1))))+2*r[1,2]*(-beta*((t-mu)*(((delta^2/(1/(1+exp(-t))^2*(1-1/(1+exp(-t)))^2)+(1-2*1/(1+exp(-t)))^2*delta^4/(4*1/(1+exp(-t))^4*(1-1/(1+exp(-t)))^4)+(1-2*1/(1+exp(-t)))*delta^3/(1/(1+exp(-t))^3*(1-1/(1+exp(-t)))^3))/((delta^2/(1/(1+exp(-t))*(1-1/(1+exp(-t))))+1)^(N/2)-1)))^(-1)))+r[2,2]*(((t-mu)^2*(((delta^2/(1/(1+exp(-t))^2*(1-1/(1+exp(-t)))^2)+(1-2*1/(1+exp(-t)))^2*delta^4/(4*1/(1+exp(-t))^4*(1-1/(1+exp(-t)))^4)+(1-2*1/(1+exp(-t)))*delta^3/(1/(1+exp(-t))^3*(1-1/(1+exp(-t)))^3))/((delta^2/(1/(1+exp(-t))*(1-1/(1+exp(-t))))+1)^(N/2)-1)))^(-1)))-1
)
}
dd<-optimize(chek,interval = c(-3,-0.0001),maximum=TRUE)
print(x )
print((dd[[2]])+500*dd[[2]]^2)
print("****************************")
if ((dd[[2]])+5000*dd[[2]]^2<0.000000001)
{break
}
}
plot(chek,-3,0)
print(i)
print("x=")
print(x)
print("delta=")
print(delta)
print(dd[2])
#print(m)
}
d(-1,1,0,120)
library(stats)#ED50=0#
options(digits = 6)
N<-300
epsilon<-0.0002
beta2<-1
beta1<-1
x1<--1.4976
beta0<- beta2*epsilon*0.5 #alpha
# beta0<- -beta2*epsilon*0.5
ll<-function(delta1)
{(((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))^2*(1-1/(1+exp(-(beta0+beta1*x1))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x1))))^2*delta1^4/(4*1/(1+exp(-(beta0+beta1*x1)))^4*(1-1/(1+exp(-(beta0+beta1*x1))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x1))))*delta1^3/(1/(1+exp(-(beta0+beta1*x1)))^3*(1-1/(1+exp(-(beta0+beta1*x1))))^3))/((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))*(1-1/(1+exp(-(beta0+beta1*x1)))))+1)^(N/2)-1)))}
f<-optimize(ll,interval = c(0.0001, 0.3),maximum=TRUE)
delta1<-f[[1]]
print(delta1)
############
efficiency<- function(x11,x12,x21,x22,x31,x32,n1,n2,n3,B0H,B1H,B2H,B0o,B1o,B2o)
{
p1H<-1/(1+exp(-(B0H+B1H*x11+B2H*x12)))
p2H<-1/(1+exp(-(B0H+B1H*x21+B2H*x22)))
p3H<-1/(1+exp(-(B0H+B1H*x31+B2H*x32)))
ll<-function(delta1)
{((((((delta1^2)/(p1H^2*(1-p1H)^2))+(0.25*((1-2*p1H)^2)*((delta1^4)/(p1H^4*(1-p1H)^4)))+(((1-2*p1H))*((delta1^3)/(p1H^3*(1-p1H)^3))))/(((((delta1^2)/(p1H*(1-p1H)))+1)^n1)-1))^(-1))*(1))}
f<-optimize(ll,interval = c(-0.5,-0.0001),maximum=TRUE)
W1<-f[[1]]
#print(W1)
}
library(stats)#ED50=0# for negative x
options(digits = 6)
d<-function(v,beta01,beta1,beta2,epsilon,N) {
for (i in 1:20000){
x1<- epsilon*0.5
beta0<- beta2*epsilon*0.5 #alpha
# beta0<- -beta2*epsilon*0.5
x2<-v-i*0.0001
ll<-function(delta1)
{(((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))^2*(1-1/(1+exp(-(beta0+beta1*x1))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x1))))^2*delta1^4/(4*1/(1+exp(-(beta0+beta1*x1)))^4*(1-1/(1+exp(-(beta0+beta1*x1))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x1))))*delta1^3/(1/(1+exp(-(beta0+beta1*x1)))^3*(1-1/(1+exp(-(beta0+beta1*x1))))^3))/((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))*(1-1/(1+exp(-(beta0+beta1*x1)))))+1)^(N/2)-1)))}
f<-optimize(ll,interval = c(0.0001, 0.3),maximum=TRUE)
delta1<-f[[1]]
lll<-function(delta2)
{(((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))^2*(1-1/(1+exp(-(beta0+beta1*x2))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x2))))^2*delta2^4/(4*1/(1+exp(-(beta0+beta1*x2)))^4*(1-1/(1+exp(-(beta0+beta1*x2))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x2))))*delta2^3/(1/(1+exp(-(beta0+beta1*x2)))^3*(1-1/(1+exp(-(beta0+beta1*x2))))^3))/((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))*(1-1/(1+exp(-(beta0+beta1*x2)))))+1)^(N/2)-1)))}
ff<-optimize(lll,interval = c(0.0001, 0.3),maximum=TRUE)
delta2<-ff[[1]]
if (ff[[2]]>f[[2]])
delta<-delta2 else delta<-delta1
m<-matrix(0,2,2)
m[1,1]<-(1*((((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))^2*(1-1/(1+exp(-(beta0+beta1*x1))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x1))))^2*delta1^4/(4*1/(1+exp(-(beta0+beta1*x1)))^4*(1-1/(1+exp(-(beta0+beta1*x1))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x1))))*delta1^3/(1/(1+exp(-(beta0+beta1*x1)))^3*(1-1/(1+exp(-(beta0+beta1*x1))))^3))/((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))*(1-1/(1+exp(-(beta0+beta1*x1)))))+1)^(N/2)-1))^(-1))))+(1*((((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))^2*(1-1/(1+exp(-(beta0+beta1*x2))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x2))))^2*delta2^4/(4*1/(1+exp(-(beta0+beta1*x2)))^4*(1-1/(1+exp(-(beta0+beta1*x2))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x2))))*(-delta2)^3/(1/(1+exp(-(beta0+beta1*x2)))^3*(1-1/(1+exp(-(beta0+beta1*x2))))^3))/((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))*(1-1/(1+exp(-(beta0+beta1*x2)))))+1)^(N/2)-1))^(-1))))
m[1,2]<-((x1)*((((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))^2*(1-1/(1+exp(-(beta0+beta1*x1))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x1))))^2*delta1^4/(4*1/(1+exp(-(beta0+beta1*x1)))^4*(1-1/(1+exp(-(beta0+beta1*x1))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x1))))*delta1^3/(1/(1+exp(-(beta0+beta1*x1)))^3*(1-1/(1+exp(-(beta0+beta1*x1))))^3))/((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))*(1-1/(1+exp(-(beta0+beta1*x1)))))+1)^(N/2)-1))^(-1))))+((x2)*((((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))^2*(1-1/(1+exp(-(beta0+beta1*x2))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x2))))^2*delta2^4/(4*1/(1+exp(-(beta0+beta1*x2)))^4*(1-1/(1+exp(-(beta0+beta1*x2))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x2))))*(-delta2)^3/(1/(1+exp(-(beta0+beta1*x2)))^3*(1-1/(1+exp(-(beta0+beta1*x2))))^3))/((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))*(1-1/(1+exp(-(beta0+beta1*x2)))))+1)^(N/2)-1))^(-1))))
m[2,1]<-m[1,2]
m[2,2]<-((x1^2)*((((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))^2*(1-1/(1+exp(-(beta0+beta1*x1))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x1))))^2*delta1^4/(4*1/(1+exp(-(beta0+beta1*x1)))^4*(1-1/(1+exp(-(beta0+beta1*x1))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x1))))*delta1^3/(1/(1+exp(-(beta0+beta1*x1)))^3*(1-1/(1+exp(-(beta0+beta1*x1))))^3))/((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))*(1-1/(1+exp(-(beta0+beta1*x1)))))+1)^(N/2)-1))^(-1))))+((x2^2)*((((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))^2*(1-1/(1+exp(-(beta0+beta1*x2))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x2))))^2*delta2^4/(4*1/(1+exp(-(beta0+beta1*x2)))^4*(1-1/(1+exp(-(beta0+beta1*x2))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x2))))*(-delta2)^3/(1/(1+exp(-(beta0+beta1*x2)))^3*(1-1/(1+exp(-(beta0+beta1*x2))))^3))/((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))*(1-1/(1+exp(-(beta0+beta1*x2)))))+1)^(N/2)-1))^(-1))))
r<- solve(m)
chek<-function(t){
2*(r[1,1]*(1*(((delta^2/(1/(1+exp(-(beta0+beta1*t)))^2*(1-1/(1+exp(-(beta0+beta1*t))))^2)+(1-2*1/(1+exp(-(beta0+beta1*t))))^2*delta^4/(4*1/(1+exp(-(beta0+beta1*t)))^4*(1-1/(1+exp(-(beta0+beta1*t))))^4)+(1-2*1/(1+exp(-(beta0+beta1*t))))*delta^3/(1/(1+exp(-(beta0+beta1*t)))^3*(1-1/(1+exp(-(beta0+beta1*t))))^3))/((delta^2/(1/(1+exp(-(beta0+beta1*t)))*(1-1/(1+exp(-(beta0+beta1*t)))))+1)^(N/2)-1))))+2*r[1,2]*(t*(((delta^2/(1/(1+exp(-(beta0+beta1*t)))^2*(1-1/(1+exp(-(beta0+beta1*t))))^2)+(1-2*1/(1+exp(-(beta0+beta1*t))))^2*delta^4/(4*1/(1+exp(-(beta0+beta1*t)))^4*(1-1/(1+exp(-(beta0+beta1*t))))^4)+(1-2*1/(1+exp(-(beta0+beta1*t))))*delta^3/(1/(1+exp(-(beta0+beta1*t)))^3*(1-1/(1+exp(-(beta0+beta1*t))))^3))/((delta^2/(1/(1+exp(-(beta0+beta1*t)))*(1-1/(1+exp(-(beta0+beta1*t)))))+1)^(N/2)-1))))+r[2,2]*(((t^2)*(((delta^2/(1/(1+exp(-(beta0+beta1*t)))^2*(1-1/(1+exp(-(beta0+beta1*t))))^2)+(1-2*1/(1+exp(-(beta0+beta1*t))))^2*delta^4/(4*1/(1+exp(-(beta0+beta1*t)))^4*(1-1/(1+exp(-(beta0+beta1*t))))^4)+(1-2*1/(1+exp(-(beta0+beta1*t))))*delta^3/(1/(1+exp(-(beta0+beta1*t)))^3*(1-1/(1+exp(-(beta0+beta1*t))))^3))/((delta^2/(1/(1+exp(-(beta0+beta1*t)))*(1-1/(1+exp(-(beta0+beta1*t)))))+1)^(N/2)-1)))^(-1)))-2
)
}
dd<-optimize(chek,interval = c(-3,-0.0001),maximum=TRUE)
print(x2 )
print((dd[[2]]^2))
print("****************************")
if ((dd[[2]])+500*dd[[2]]^2<0.000000001)
{break
}
}
#plot(chek,0,3)
# print(i)
print("x2=")
print(x2)
print("delta=")
print(delta)
print(dd[2])
}
d(-0.1,0,1,1,0.0002,24)
#############Delta in Table 2
N<-300
epsilon<-0.0002
beta2<-1
beta1<-1
x1<--1.4976
beta0<- beta2*epsilon*0.5 #alpha
# beta0<- -beta2*epsilon*0.5
ll<-function(delta1)
{(((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))^2*(1-1/(1+exp(-(beta0+beta1*x1))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x1))))^2*delta1^4/(4*1/(1+exp(-(beta0+beta1*x1)))^4*(1-1/(1+exp(-(beta0+beta1*x1))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x1))))*delta1^3/(1/(1+exp(-(beta0+beta1*x1)))^3*(1-1/(1+exp(-(beta0+beta1*x1))))^3))/((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))*(1-1/(1+exp(-(beta0+beta1*x1)))))+1)^(N/2)-1)))}
f<-optimize(ll,interval = c(0.0001, 0.3),maximum=TRUE)
delta1<-f[[1]]
print(delta1)
library(stats)#ED50=0# for negative x
options(digits = 6)
d<-function(v,beta01,beta1,beta2,epsilon,N) {
for (i in 1:20000){
x1<- epsilon*0.5
beta0<- beta2*epsilon*0.5 #alpha
# beta0<- -beta2*epsilon*0.5
x2<-v+i*0.0001
ll<-function(delta1)
{(((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))^2*(1-1/(1+exp(-(beta0+beta1*x1))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x1))))^2*delta1^4/(4*1/(1+exp(-(beta0+beta1*x1)))^4*(1-1/(1+exp(-(beta0+beta1*x1))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x1))))*delta1^3/(1/(1+exp(-(beta0+beta1*x1)))^3*(1-1/(1+exp(-(beta0+beta1*x1))))^3))/((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))*(1-1/(1+exp(-(beta0+beta1*x1)))))+1)^(N/2)-1)))}
f<-optimize(ll,interval = c(0.0001, 0.3),maximum=TRUE)
delta1<-f[[1]]
lll<-function(delta2)
{(((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))^2*(1-1/(1+exp(-(beta0+beta1*x2))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x2))))^2*delta2^4/(4*1/(1+exp(-(beta0+beta1*x2)))^4*(1-1/(1+exp(-(beta0+beta1*x2))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x2))))*delta2^3/(1/(1+exp(-(beta0+beta1*x2)))^3*(1-1/(1+exp(-(beta0+beta1*x2))))^3))/((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))*(1-1/(1+exp(-(beta0+beta1*x2)))))+1)^(N/2)-1)))}
ff<-optimize(lll,interval = c(0.0001, 0.3),maximum=TRUE)
delta2<-ff[[1]]
if (ff[[2]]>f[[2]])
delta<-delta2 else delta<-delta1
m<-matrix(0,2,2)
m[1,1]<-(1*((((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))^2*(1-1/(1+exp(-(beta0+beta1*x1))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x1))))^2*delta1^4/(4*1/(1+exp(-(beta0+beta1*x1)))^4*(1-1/(1+exp(-(beta0+beta1*x1))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x1))))*delta1^3/(1/(1+exp(-(beta0+beta1*x1)))^3*(1-1/(1+exp(-(beta0+beta1*x1))))^3))/((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))*(1-1/(1+exp(-(beta0+beta1*x1)))))+1)^(N/2)-1))^(-1))))+(1*((((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))^2*(1-1/(1+exp(-(beta0+beta1*x2))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x2))))^2*delta2^4/(4*1/(1+exp(-(beta0+beta1*x2)))^4*(1-1/(1+exp(-(beta0+beta1*x2))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x2))))*(-delta2)^3/(1/(1+exp(-(beta0+beta1*x2)))^3*(1-1/(1+exp(-(beta0+beta1*x2))))^3))/((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))*(1-1/(1+exp(-(beta0+beta1*x2)))))+1)^(N/2)-1))^(-1))))
m[1,2]<-((x1)*((((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))^2*(1-1/(1+exp(-(beta0+beta1*x1))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x1))))^2*delta1^4/(4*1/(1+exp(-(beta0+beta1*x1)))^4*(1-1/(1+exp(-(beta0+beta1*x1))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x1))))*delta1^3/(1/(1+exp(-(beta0+beta1*x1)))^3*(1-1/(1+exp(-(beta0+beta1*x1))))^3))/((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))*(1-1/(1+exp(-(beta0+beta1*x1)))))+1)^(N/2)-1))^(-1))))+((x2)*((((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))^2*(1-1/(1+exp(-(beta0+beta1*x2))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x2))))^2*delta2^4/(4*1/(1+exp(-(beta0+beta1*x2)))^4*(1-1/(1+exp(-(beta0+beta1*x2))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x2))))*(-delta2)^3/(1/(1+exp(-(beta0+beta1*x2)))^3*(1-1/(1+exp(-(beta0+beta1*x2))))^3))/((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))*(1-1/(1+exp(-(beta0+beta1*x2)))))+1)^(N/2)-1))^(-1))))
m[2,1]<-m[1,2]
m[2,2]<-((x1^2)*((((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))^2*(1-1/(1+exp(-(beta0+beta1*x1))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x1))))^2*delta1^4/(4*1/(1+exp(-(beta0+beta1*x1)))^4*(1-1/(1+exp(-(beta0+beta1*x1))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x1))))*delta1^3/(1/(1+exp(-(beta0+beta1*x1)))^3*(1-1/(1+exp(-(beta0+beta1*x1))))^3))/((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))*(1-1/(1+exp(-(beta0+beta1*x1)))))+1)^(N/2)-1))^(-1))))+((x2^2)*((((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))^2*(1-1/(1+exp(-(beta0+beta1*x2))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x2))))^2*delta2^4/(4*1/(1+exp(-(beta0+beta1*x2)))^4*(1-1/(1+exp(-(beta0+beta1*x2))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x2))))*(-delta2)^3/(1/(1+exp(-(beta0+beta1*x2)))^3*(1-1/(1+exp(-(beta0+beta1*x2))))^3))/((delta2^2/(1/(1+exp(-(beta0+beta1*x2)))*(1-1/(1+exp(-(beta0+beta1*x2)))))+1)^(N/2)-1))^(-1))))
r<- solve(m)
chek<-function(t){
2*(r[1,1]*(1*(((delta^2/(1/(1+exp(-(beta0+beta1*t)))^2*(1-1/(1+exp(-(beta0+beta1*t))))^2)+(1-2*1/(1+exp(-(beta0+beta1*t))))^2*delta^4/(4*1/(1+exp(-(beta0+beta1*t)))^4*(1-1/(1+exp(-(beta0+beta1*t))))^4)+(1-2*1/(1+exp(-(beta0+beta1*t))))*delta^3/(1/(1+exp(-(beta0+beta1*t)))^3*(1-1/(1+exp(-(beta0+beta1*t))))^3))/((delta^2/(1/(1+exp(-(beta0+beta1*t)))*(1-1/(1+exp(-(beta0+beta1*t)))))+1)^(N/2)-1))))+2*r[1,2]*(t*(((delta^2/(1/(1+exp(-(beta0+beta1*t)))^2*(1-1/(1+exp(-(beta0+beta1*t))))^2)+(1-2*1/(1+exp(-(beta0+beta1*t))))^2*delta^4/(4*1/(1+exp(-(beta0+beta1*t)))^4*(1-1/(1+exp(-(beta0+beta1*t))))^4)+(1-2*1/(1+exp(-(beta0+beta1*t))))*delta^3/(1/(1+exp(-(beta0+beta1*t)))^3*(1-1/(1+exp(-(beta0+beta1*t))))^3))/((delta^2/(1/(1+exp(-(beta0+beta1*t)))*(1-1/(1+exp(-(beta0+beta1*t)))))+1)^(N/2)-1))))+r[2,2]*(((t^2)*(((delta^2/(1/(1+exp(-(beta0+beta1*t)))^2*(1-1/(1+exp(-(beta0+beta1*t))))^2)+(1-2*1/(1+exp(-(beta0+beta1*t))))^2*delta^4/(4*1/(1+exp(-(beta0+beta1*t)))^4*(1-1/(1+exp(-(beta0+beta1*t))))^4)+(1-2*1/(1+exp(-(beta0+beta1*t))))*delta^3/(1/(1+exp(-(beta0+beta1*t)))^3*(1-1/(1+exp(-(beta0+beta1*t))))^3))/((delta^2/(1/(1+exp(-(beta0+beta1*t)))*(1-1/(1+exp(-(beta0+beta1*t)))))+1)^(N/2)-1)))^(-1)))-2
)
}
dd<-optimize(chek,interval = c(-3,-0.0001),maximum=TRUE)
print(x2 )
print((dd[[2]]^2))
print("****************************")
if ((dd[[2]])+500*dd[[2]]^2<0.000000001)
{break
}
}
#plot(chek,0,3)
# print(i)
print("x2=")
print(x2)
print("delta=")
print(delta)
print(dd[2])
}
d(-1.5,0,1,1,0.0002,24)
#############Delta in Table 2
N<-300
epsilon<-0.0002
beta2<-1
beta1<-1
x1<--1.4976
beta0<- beta2*epsilon*0.5 #alpha
# beta0<- -beta2*epsilon*0.5
ll<-function(delta1)
{(((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))^2*(1-1/(1+exp(-(beta0+beta1*x1))))^2)+(1-2*1/(1+exp(-(beta0+beta1*x1))))^2*delta1^4/(4*1/(1+exp(-(beta0+beta1*x1)))^4*(1-1/(1+exp(-(beta0+beta1*x1))))^4)+(1-2*1/(1+exp(-(beta0+beta1*x1))))*delta1^3/(1/(1+exp(-(beta0+beta1*x1)))^3*(1-1/(1+exp(-(beta0+beta1*x1))))^3))/((delta1^2/(1/(1+exp(-(beta0+beta1*x1)))*(1-1/(1+exp(-(beta0+beta1*x1)))))+1)^(N/2)-1)))}
f<-optimize(ll,interval = c(0.0001, 0.3),maximum=TRUE)
delta1<-f[[1]]
print(delta1)
